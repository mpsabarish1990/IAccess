<link type="text/css" href="../SiteAssets/iAccess/StyleSheets/bootstrap.min.css" rel="stylesheet" />

<link type="text/css" href="../SiteAssets/iAccess/StyleSheets/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="../SiteAssets/iAccess/StyleSheets/style.css" rel="stylesheet">
<link type="text/css" href="../SiteAssets/iAccess/StyleSheets/package/mdl/material.css" rel="stylesheet">
<script type="text/javascript" src="../SiteAssets/iAccess/Scripts/jquery-1.12.4.js"></script>
<script type="text/javascript" src="../SiteAssets/iAccess/Scripts/handlebars-v4.0.10.js"></script>

<script src="../SiteAssets/iAccess/Scripts/moment.min.js"></script>
<script src="../SiteAssets/iAccess/Stylesheets/package/mdl/material.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../SiteAssets/iAccess/Scripts/ViewRequest.js"></script>
<script type="text/javascript" src="../SiteAssets/iAccess/Scripts/camljs.js"></script>
<script type="text/javascript" src="../SiteAssets/iAccess/Scripts/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../SiteAssets/iAccess/Scripts/dataTables.bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.SPServices/2014.02/jquery.SPServices-2014.02.js"></script>

<p class="adnewbutton">
   <span id="bntAddRow" class="addrow toggleclick">+</span>
</p>


 <h4 class="main_title"><span>My Requests</span></h4>
<table id="DataTable_table" class="table table-striped table-bordered">
    <thead id="DataTable_thead">
    </thead>
    <tbody id="DataTable_tbody">
    </tbody>
</table>

<script>
    jQuery(document).ready(function () {
        $("#bntAddRow").click(function () {
            window.location.href = _spPageContextInfo.webAbsoluteUrl + "/Pages/NewRequest.aspx";
        });
    });
</script>

<!-- <div id="content"></div>
<script id="DataTable-template" type="text/x-handlebars-template">
<h4 id="RequestHeading">View Request</h4>
<table id="DataTable_table" class="table table-striped table-bordered">
    <thead id="DataTable_thead">
    <tr>								
    	<th>Requester Name</th>				
    	<th>Requester Manager</th>	
    	<th>Request Details</th>	
    	<th>Request ID</th>				
        <th>View</th>     
        
    </tr>
    </thead>
    <tbody id="DataTable_tbody">
    {{#results}}
    <tr>
    <td>{{#Requester}}{{Title}}{{/Requester}}</td>
    <td>{{#anager}}{{Title}}{{/anager}}</td>
     <td>{{Removedivtag Request_x0020_Details}}</td> 
    <td>{{RequestId}}</td>    
     
     <td>{{UrlFormat ID}}</td> 
  
     </tr>
    {{/results}}
    </tbody>
</table>
</script>


<script type="text/javascript">

    $(document).ready(function () {
       // load_viewRequest();
    });
    function load_viewRequest() {
        var endPointUrl = _spPageContextInfo.webAbsoluteUrl + "/_api/web/lists/getbytitle('ITRequest')/items?$select=ID,Requester/Id,Requester/Title,anager/Id,anager/Title,Request_x0020_Details,RequestId&$expand=Requester,anager";

        var headers = { "Accept": "application/json; odata=verbose" };

        jQuery.ajax({

            url: endPointUrl,

            type: "GET",

            headers: headers,

            success: function (data) {

                var source = $("#DataTable-template").html();

                var template = Handlebars.compile(source);

                var output = template(data.d);

                $("#content").html(output);
            },

            error: function (err) {

                alert("Error Occured:" + JSON.stringify(err));

            }

        });
    }
    Handlebars.registerHelper("Removedivtag", function (data) {
        var format = $(data).text();
        return format;
    });
    Handlebars.registerHelper('UrlFormat', function (my_link) {

        var url = Handlebars.escapeExpression(my_link);
        var result = "<a href='" + _spPageContextInfo.webAbsoluteUrl + "/Lists/ITRequest/DispForm.aspx?ID=" + url + "'>View</a>";
        //console.log(result);

        return new Handlebars.SafeString(result);

    });
</script>
<head><title></title></head> -->